# Netlify 配置文件

# 构建设置
[build]
  # 构建命令
  command = "yarn build"
  # 构建输出目录
  publish = "./dist"
  # 环境变量
  environment = { NODE_VERSION = "20" }

# 重定向规则 - 解决 SSR 路由问题
[[redirects]]
  # 所有请求都由 Netlify Functions 处理
  from = "/*"
  to = "/.netlify/functions/server"
  status = 200
  force = false

# 功能标志
[functions]
  # 函数目录
  directory = "./.netlify/functions"
  # 函数超时时间
  timeout = 10

# 缓存规则
[[headers]]
  for = "/*"
  [headers.values]
    Cache-Control = "public, max-age=0, must-revalidate"

[[headers]]
  for = "/_nuxt/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/favicon.ico"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# 边缘功能配置
[edge_functions]
  # 边缘函数目录
  directory = "./netlify/edge-functions"

# 部署前钩子
[build.processing]
  # 自动压缩
  minify = { css = true, js = true }
  # 生成摘要文件
  html = { pretty_urls = true }
